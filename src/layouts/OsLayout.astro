---
import "../styles/global.css";
import { ClientRouter } from "astro:transitions";

interface Props {
  title: string;
  description?: string;
}

const { title, description = "Smeax OS - Une expérience interactive cachée" } =
  Astro.props;
---

<!doctype html>
<html lang="fr" class="h-full overflow-hidden">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="theme-color" content="#020617" />
    <link
      rel="icon"
      type="image/png"
      href={`${import.meta.env.BASE_URL}icon.png`}
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="manifest" href={`${import.meta.env.BASE_URL}manifest.json`} />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="ShadowOS" />
    <ClientRouter />
    <script src="https://unpkg.com/lucide@latest" is:inline></script>
    <style>
      /* Prevent scrolling on the body to allow full-screen OS feel */
      body {
        overscroll-behavior: none;
        touch-action: none;
      }
    </style>
  </head>
  <body
    class="h-full w-full bg-midnight text-text-main antialiased font-sans overflow-hidden selection:bg-purple-500/30 selection:text-purple-200"
  >
    <main class="relative h-full w-full overflow-hidden">
      <slot />
    </main>

    <script is:inline>
      // Initialize Lucide icons
      function initIcons() {
        if (window.lucide) {
          window.lucide.createIcons();
        }
      }
      document.addEventListener("DOMContentLoaded", initIcons);
      document.addEventListener("astro:after-swap", initIcons);
    </script>
    <script is:inline>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register(`${import.meta.env.BASE_URL}sw.js`)
            .then((reg) => console.log("SW registered"))
            .catch((err) => console.log("SW error", err));
        });
      }
    </script>
  </body>
</html>
